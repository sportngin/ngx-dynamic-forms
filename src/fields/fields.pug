mixin fields(displayOnly = false, formVarName = 'form', formGroup = false, controlVarName = 'control')
    layout(*ngIf=`${controlVarName}.elementType === "layout" && isRendered(${controlVarName})`, [class]='control.cssClass', [control]='control', [form]=`${formVarName }`, [displayOnly]=`${displayOnly}`)
    form-page-root(*ngIf='(control.elementType === "page" || control.elementType === "pageRoot") && isRendered(control)', [form]=`${formVarName}`, [control]='control')
    if formGroup
        span(*ngIf='!displayOnly && control.elementType !== "layout" && isRendered(control)', [formGroup]=`${formVarName}`)
            +controls(formVarName)
    else
        +controls(formVarName)
    ng-container(*ngIf='displayOnly && control.elementType !== "layout" && !control.hidden && isRendered(control)')
        | {{control.name && #{formVarName}.controls[control.name] && #{formVarName}.controls[control.name].displayValue || #{formVarName}.value[control.name]}}
    input(
        *ngIf='control.elementType === "submit" && isRendered(control)',
        type='submit',
        [value]='getText(control.text)',
        [class]='"btn btn-" + control.member.buttonClass',
        [attr.disabled]='control.disabled ? "" : null',
        [disabled]='isDisabled(control)'
    )
    button(
        type='button',
        *ngIf='control.elementType === "button" && isRendered(control)',
        [class]='"btn btn-" + control.member.buttonClass + " " + control.cssClass',
        (click)=`handleBehavior(control.member.buttonAction, ${formVarName})`,
        [attr.disabled]='control.disabled ? "" : null',
        [disabled]='isDisabled(control)'
        ) {{getText(control.text)}}


mixin controls(formVarName)
    dyn-field(*ngIf='control.elementType === "control" && isRendered(control)', [control]='control', [form]=`${formVarName}`, [formControlName]='control.name')
    dyn-field(*ngIf='control.elementType === "array" && isRendered(control)',   [control]='control', [form]=`${formVarName}`, [formArrayName]='control.name')


mixin helpers(position, controlVarName = 'control')
    ng-template(ngFor let-helper [ngForOf]=`${controlVarName}.member.helpers | position:'${position}'`)
        p(*ngIf=`isRendered(${controlVarName}) && isRendered(helper)`, [class]='"helper " + (helper.cssClass || "")', [innerHTML]='helper.text')